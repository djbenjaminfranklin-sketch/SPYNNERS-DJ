{"dependencies":[{"name":"../utils/sharedInstance","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":60,"index":60}}],"key":"fZWaVZXRV+td3A9HZ0+ZfG+s/ro=","exportNames":["*"],"imports":1}},{"name":"../utils/common","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":61},"end":{"line":2,"column":47,"index":108}}],"key":"KsodrK4j9cfxMx/6SogWBqcOsfM=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"USER_HEARTBEAT_EVENT_NAME\", {\n    enumerable: true,\n    get: function () {\n      return USER_HEARTBEAT_EVENT_NAME;\n    }\n  });\n  Object.defineProperty(exports, \"ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY\", {\n    enumerable: true,\n    get: function () {\n      return ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY;\n    }\n  });\n  Object.defineProperty(exports, \"ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY\", {\n    enumerable: true,\n    get: function () {\n      return ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY;\n    }\n  });\n  Object.defineProperty(exports, \"createAnalyticsModule\", {\n    enumerable: true,\n    get: function () {\n      return createAnalyticsModule;\n    }\n  });\n  exports.getAnalyticsConfigFromUrlParams = getAnalyticsConfigFromUrlParams;\n  exports.getAnalyticsSessionId = getAnalyticsSessionId;\n  var _utilsSharedInstance = require(_dependencyMap[0], \"../utils/sharedInstance\");\n  var _utilsCommon = require(_dependencyMap[1], \"../utils/common\");\n  const USER_HEARTBEAT_EVENT_NAME = \"__user_heartbeat_event__\";\n  const ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY = \"analytics-enable\";\n  const ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY = \"base44_analytics_session_id\";\n  const defaultConfiguration = {\n    // default to disabled //\n    enabled: false,\n    maxQueueSize: 1000,\n    throttleTime: 1000,\n    batchSize: 30,\n    heartBeatInterval: 60 * 1000\n  };\n  ///////////////////////////////////////////////\n  //// shared queue for analytics events     ////\n  ///////////////////////////////////////////////\n  const ANALYTICS_SHARED_STATE_NAME = \"analytics\";\n  // shared state//\n  const analyticsSharedState = (0, _utilsSharedInstance.getSharedInstance)(ANALYTICS_SHARED_STATE_NAME, () => ({\n    requestsQueue: [],\n    isProcessing: false,\n    isHeartBeatProcessing: false,\n    sessionContext: null,\n    config: {\n      ...defaultConfiguration,\n      ...getAnalyticsConfigFromUrlParams()\n    }\n  }));\n  const createAnalyticsModule = ({\n    axiosClient,\n    serverUrl,\n    appId,\n    userAuthModule\n  }) => {\n    var _a;\n    // prevent overflow of events //\n    const {\n      maxQueueSize,\n      throttleTime,\n      batchSize\n    } = analyticsSharedState.config;\n    if (!((_a = analyticsSharedState.config) === null || _a === void 0 ? void 0 : _a.enabled)) {\n      return {\n        track: () => {},\n        cleanup: () => {}\n      };\n    }\n    let clearHeartBeatProcessor = undefined;\n    const trackBatchUrl = `${serverUrl}/api/apps/${appId}/analytics/track/batch`;\n    const batchRequestFallback = async events => {\n      await axiosClient.request({\n        method: \"POST\",\n        url: `/apps/${appId}/analytics/track/batch`,\n        data: {\n          events\n        }\n      });\n    };\n    // currently disabled, until fully tested  //\n    const beaconRequest = events => {\n      try {\n        const beaconPayload = JSON.stringify({\n          events\n        });\n        const blob = new Blob([beaconPayload], {\n          type: \"application/json\"\n        });\n        return typeof navigator === \"undefined\" || beaconPayload.length > 60000 || !navigator.sendBeacon(trackBatchUrl, blob);\n      } catch (_a) {\n        return false;\n      }\n    };\n    const flush = async (eventsData, options = {}) => {\n      if (eventsData.length === 0) return;\n      const sessionContext_ = await getSessionContext(userAuthModule);\n      const events = eventsData.map(transformEventDataToApiRequestData(sessionContext_));\n      try {\n        if (!options.isBeacon || !beaconRequest(events)) {\n          await batchRequestFallback(events);\n        }\n      } catch (_a) {\n        // do nothing\n      }\n    };\n    const startProcessing = () => {\n      startAnalyticsProcessor(flush, {\n        throttleTime,\n        batchSize\n      });\n    };\n    const track = params => {\n      if (analyticsSharedState.requestsQueue.length >= maxQueueSize) {\n        return;\n      }\n      const intrinsicData = getEventIntrinsicData();\n      analyticsSharedState.requestsQueue.push({\n        ...params,\n        ...intrinsicData\n      });\n      startProcessing();\n    };\n    const onDocVisible = () => {\n      startAnalyticsProcessor(flush, {\n        throttleTime,\n        batchSize\n      });\n      clearHeartBeatProcessor = startHeartBeatProcessor(track);\n    };\n    const onDocHidden = () => {\n      stopAnalyticsProcessor();\n      clearHeartBeatProcessor === null || clearHeartBeatProcessor === void 0 ? void 0 : clearHeartBeatProcessor();\n      //  flush entire queue on visibility change and hope for the best //\n      const eventsData = analyticsSharedState.requestsQueue.splice(0);\n      flush(eventsData, {\n        isBeacon: true\n      });\n    };\n    const onVisibilityChange = () => {\n      if (typeof window === \"undefined\") return;\n      if (document.visibilityState === \"hidden\") {\n        onDocHidden();\n      } else if (document.visibilityState === \"visible\") {\n        onDocVisible();\n      }\n    };\n    const cleanup = () => {\n      stopAnalyticsProcessor();\n      clearHeartBeatProcessor === null || clearHeartBeatProcessor === void 0 ? void 0 : clearHeartBeatProcessor();\n      if (typeof window !== \"undefined\") {\n        window.removeEventListener(\"visibilitychange\", onVisibilityChange);\n      }\n    };\n    // start the flusing process ///\n    startProcessing();\n    // start the heart beat processor //\n    clearHeartBeatProcessor = startHeartBeatProcessor(track);\n    // start the visibility change listener //\n    if (typeof window !== \"undefined\") {\n      window.addEventListener(\"visibilitychange\", onVisibilityChange);\n    }\n    return {\n      track,\n      cleanup\n    };\n  };\n  function stopAnalyticsProcessor() {\n    analyticsSharedState.isProcessing = false;\n  }\n  async function startAnalyticsProcessor(handleTrack, options) {\n    if (analyticsSharedState.isProcessing) {\n      // only one instance of the analytics processor can be running at a time //\n      return;\n    }\n    analyticsSharedState.isProcessing = true;\n    const {\n      throttleTime = 1000,\n      batchSize = 30\n    } = options !== null && options !== void 0 ? options : {};\n    while (analyticsSharedState.isProcessing && analyticsSharedState.requestsQueue.length > 0) {\n      const requests = analyticsSharedState.requestsQueue.splice(0, batchSize);\n      requests.length && (await handleTrack(requests));\n      await new Promise(resolve => setTimeout(resolve, throttleTime));\n    }\n    analyticsSharedState.isProcessing = false;\n  }\n  function startHeartBeatProcessor(track) {\n    var _a;\n    if (analyticsSharedState.isHeartBeatProcessing || ((_a = analyticsSharedState.config.heartBeatInterval) !== null && _a !== void 0 ? _a : 0) < 10) {\n      return () => {};\n    }\n    analyticsSharedState.isHeartBeatProcessing = true;\n    const interval = setInterval(() => {\n      track({\n        eventName: USER_HEARTBEAT_EVENT_NAME\n      });\n    }, analyticsSharedState.config.heartBeatInterval);\n    return () => {\n      clearInterval(interval);\n      analyticsSharedState.isHeartBeatProcessing = false;\n    };\n  }\n  function getEventIntrinsicData() {\n    return {\n      timestamp: new Date().toISOString(),\n      pageUrl: typeof window !== \"undefined\" ? window.location.pathname : null\n    };\n  }\n  function transformEventDataToApiRequestData(sessionContext) {\n    return eventData => ({\n      event_name: eventData.eventName,\n      properties: eventData.properties,\n      timestamp: eventData.timestamp,\n      page_url: eventData.pageUrl,\n      ...sessionContext\n    });\n  }\n  let sessionContextPromise = null;\n  async function getSessionContext(userAuthModule) {\n    if (!analyticsSharedState.sessionContext) {\n      if (!sessionContextPromise) {\n        const sessionId = getAnalyticsSessionId();\n        sessionContextPromise = userAuthModule.me().then(user => ({\n          user_id: user.id,\n          session_id: sessionId\n        })).catch(() => ({\n          user_id: null,\n          session_id: sessionId\n        }));\n      }\n      analyticsSharedState.sessionContext = await sessionContextPromise;\n    }\n    return analyticsSharedState.sessionContext;\n  }\n  function getAnalyticsConfigFromUrlParams() {\n    if (typeof window === \"undefined\") return undefined;\n    const urlParams = new URLSearchParams(window.location.search);\n    const analyticsEnable = urlParams.get(ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY);\n    // if the url param is not set, return undefined //\n    if (analyticsEnable == null || !analyticsEnable.length) return undefined;\n    // remove the url param from the url //\n    const newUrlParams = new URLSearchParams(window.location.search);\n    newUrlParams.delete(ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY);\n    const newUrl = window.location.pathname + (newUrlParams.toString() ? \"?\" + newUrlParams.toString() : \"\");\n    window.history.replaceState({}, \"\", newUrl);\n    // return the config object //\n    return {\n      enabled: analyticsEnable === \"true\"\n    };\n  }\n  function getAnalyticsSessionId() {\n    if (typeof window === \"undefined\") {\n      return (0, _utilsCommon.generateUuid)();\n    }\n    try {\n      const sessionId = localStorage.getItem(ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY);\n      if (!sessionId) {\n        const newSessionId = (0, _utilsCommon.generateUuid)();\n        localStorage.setItem(ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY, newSessionId);\n        return newSessionId;\n      }\n      return sessionId;\n    } catch (_a) {\n      return (0, _utilsCommon.generateUuid)();\n    }\n  }\n});","lineCount":278,"map":[[7,2,3,0,"Object"],[7,8,3,0],[7,9,3,0,"defineProperty"],[7,23,3,0],[7,24,3,0,"exports"],[7,31,3,0],[8,4,3,0,"enumerable"],[8,14,3,0],[9,4,3,0,"get"],[9,7,3,0],[9,18,3,0,"get"],[9,19,3,0],[10,6,3,0],[10,13,3,0,"USER_HEARTBEAT_EVENT_NAME"],[10,38,3,0],[11,4,3,0],[12,2,3,0],[13,2,4,0,"Object"],[13,8,4,0],[13,9,4,0,"defineProperty"],[13,23,4,0],[13,24,4,0,"exports"],[13,31,4,0],[14,4,4,0,"enumerable"],[14,14,4,0],[15,4,4,0,"get"],[15,7,4,0],[15,18,4,0,"get"],[15,19,4,0],[16,6,4,0],[16,13,4,0,"ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY"],[16,50,4,0],[17,4,4,0],[18,2,4,0],[19,2,5,0,"Object"],[19,8,5,0],[19,9,5,0,"defineProperty"],[19,23,5,0],[19,24,5,0,"exports"],[19,31,5,0],[20,4,5,0,"enumerable"],[20,14,5,0],[21,4,5,0,"get"],[21,7,5,0],[21,18,5,0,"get"],[21,19,5,0],[22,6,5,0],[22,13,5,0,"ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY"],[22,51,5,0],[23,4,5,0],[24,2,5,0],[25,2,29,0,"Object"],[25,8,29,0],[25,9,29,0,"defineProperty"],[25,23,29,0],[25,24,29,0,"exports"],[25,31,29,0],[26,4,29,0,"enumerable"],[26,14,29,0],[27,4,29,0,"get"],[27,7,29,0],[27,18,29,0,"get"],[27,19,29,0],[28,6,29,0],[28,13,29,0,"createAnalyticsModule"],[28,34,29,0],[29,4,29,0],[30,2,29,0],[31,2,204,0,"exports"],[31,9,204,0],[31,10,204,0,"getAnalyticsConfigFromUrlParams"],[31,41,204,0],[31,44,204,0,"getAnalyticsConfigFromUrlParams"],[31,75,204,0],[32,2,221,0,"exports"],[32,9,221,0],[32,10,221,0,"getAnalyticsSessionId"],[32,31,221,0],[32,34,221,0,"getAnalyticsSessionId"],[32,55,221,0],[33,2,1,0],[33,6,1,0,"_utilsSharedInstance"],[33,26,1,0],[33,29,1,0,"require"],[33,36,1,0],[33,37,1,0,"_dependencyMap"],[33,51,1,0],[34,2,2,0],[34,6,2,0,"_utilsCommon"],[34,18,2,0],[34,21,2,0,"require"],[34,28,2,0],[34,29,2,0,"_dependencyMap"],[34,43,2,0],[35,2,3,7],[35,8,3,13,"USER_HEARTBEAT_EVENT_NAME"],[35,33,3,38],[35,36,3,41],[35,62,3,67],[36,2,4,7],[36,8,4,13,"ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY"],[36,45,4,50],[36,48,4,53],[36,66,4,71],[37,2,5,7],[37,8,5,13,"ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY"],[37,46,5,51],[37,49,5,54],[37,78,5,83],[38,2,6,0],[38,8,6,6,"defaultConfiguration"],[38,28,6,26],[38,31,6,29],[39,4,7,4],[40,4,8,4,"enabled"],[40,11,8,11],[40,13,8,13],[40,18,8,18],[41,4,9,4,"maxQueueSize"],[41,16,9,16],[41,18,9,18],[41,22,9,22],[42,4,10,4,"throttleTime"],[42,16,10,16],[42,18,10,18],[42,22,10,22],[43,4,11,4,"batchSize"],[43,13,11,13],[43,15,11,15],[43,17,11,17],[44,4,12,4,"heartBeatInterval"],[44,21,12,21],[44,23,12,23],[44,25,12,25],[44,28,12,28],[45,2,13,0],[45,3,13,1],[46,2,14,0],[47,2,15,0],[48,2,16,0],[49,2,17,0],[49,8,17,6,"ANALYTICS_SHARED_STATE_NAME"],[49,35,17,33],[49,38,17,36],[49,49,17,47],[50,2,18,0],[51,2,19,0],[51,8,19,6,"analyticsSharedState"],[51,28,19,26],[51,31,19,29],[51,35,19,29,"getSharedInstance"],[51,55,19,46],[51,56,19,46,"getSharedInstance"],[51,73,19,46],[51,75,19,47,"ANALYTICS_SHARED_STATE_NAME"],[51,102,19,74],[51,104,19,76],[51,111,19,83],[52,4,20,4,"requestsQueue"],[52,17,20,17],[52,19,20,19],[52,21,20,21],[53,4,21,4,"isProcessing"],[53,16,21,16],[53,18,21,18],[53,23,21,23],[54,4,22,4,"isHeartBeatProcessing"],[54,25,22,25],[54,27,22,27],[54,32,22,32],[55,4,23,4,"sessionContext"],[55,18,23,18],[55,20,23,20],[55,24,23,24],[56,4,24,4,"config"],[56,10,24,10],[56,12,24,12],[57,6,25,8],[57,9,25,11,"defaultConfiguration"],[57,29,25,31],[58,6,26,8],[58,9,26,11,"getAnalyticsConfigFromUrlParams"],[58,40,26,42],[58,41,26,43],[59,4,27,4],[60,2,28,0],[60,3,28,1],[60,4,28,2],[60,5,28,3],[61,2,29,7],[61,8,29,13,"createAnalyticsModule"],[61,29,29,34],[61,32,29,37,"createAnalyticsModule"],[61,33,29,38],[62,4,29,40,"axiosClient"],[62,15,29,51],[63,4,29,53,"serverUrl"],[63,13,29,62],[64,4,29,64,"appId"],[64,9,29,69],[65,4,29,71,"userAuthModule"],[66,2,29,87],[66,3,29,88],[66,8,29,93],[67,4,30,4],[67,8,30,8,"_a"],[67,10,30,10],[68,4,31,4],[69,4,32,4],[69,10,32,10],[70,6,32,12,"maxQueueSize"],[70,18,32,24],[71,6,32,26,"throttleTime"],[71,18,32,38],[72,6,32,40,"batchSize"],[73,4,32,50],[73,5,32,51],[73,8,32,54,"analyticsSharedState"],[73,28,32,74],[73,29,32,75,"config"],[73,35,32,81],[74,4,33,4],[74,8,33,8],[74,10,33,10],[74,11,33,11,"_a"],[74,13,33,13],[74,16,33,16,"analyticsSharedState"],[74,36,33,36],[74,37,33,37,"config"],[74,43,33,43],[74,49,33,49],[74,53,33,53],[74,57,33,57,"_a"],[74,59,33,59],[74,64,33,64],[74,69,33,69],[74,70,33,70],[74,73,33,73],[74,78,33,78],[74,79,33,79],[74,82,33,82,"_a"],[74,84,33,84],[74,85,33,85,"enabled"],[74,92,33,92],[74,93,33,93],[74,95,33,95],[75,6,34,8],[75,13,34,15],[76,8,35,12,"track"],[76,13,35,17],[76,15,35,19,"track"],[76,16,35,19],[76,21,35,25],[76,22,35,27],[76,23,35,28],[77,8,36,12,"cleanup"],[77,15,36,19],[77,17,36,21,"cleanup"],[77,18,36,21],[77,23,36,27],[77,24,36,29],[78,6,37,8],[78,7,37,9],[79,4,38,4],[80,4,39,4],[80,8,39,8,"clearHeartBeatProcessor"],[80,31,39,31],[80,34,39,34,"undefined"],[80,43,39,43],[81,4,40,4],[81,10,40,10,"trackBatchUrl"],[81,23,40,23],[81,26,40,26],[81,29,40,29,"serverUrl"],[81,38,40,38],[81,51,40,51,"appId"],[81,56,40,56],[81,80,40,80],[82,4,41,4],[82,10,41,10,"batchRequestFallback"],[82,30,41,30],[82,33,41,33],[82,39,41,40,"events"],[82,45,41,46],[82,49,41,51],[83,6,42,8],[83,12,42,14,"axiosClient"],[83,23,42,25],[83,24,42,26,"request"],[83,31,42,33],[83,32,42,34],[84,8,43,12,"method"],[84,14,43,18],[84,16,43,20],[84,22,43,26],[85,8,44,12,"url"],[85,11,44,15],[85,13,44,17],[85,22,44,26,"appId"],[85,27,44,31],[85,51,44,55],[86,8,45,12,"data"],[86,12,45,16],[86,14,45,18],[87,10,45,20,"events"],[88,8,45,27],[89,6,46,8],[89,7,46,9],[89,8,46,10],[90,4,47,4],[90,5,47,5],[91,4,48,4],[92,4,49,4],[92,10,49,10,"beaconRequest"],[92,23,49,23],[92,26,49,27,"events"],[92,32,49,33],[92,36,49,38],[93,6,50,8],[93,10,50,12],[94,8,51,12],[94,14,51,18,"beaconPayload"],[94,27,51,31],[94,30,51,34,"JSON"],[94,34,51,38],[94,35,51,39,"stringify"],[94,44,51,48],[94,45,51,49],[95,10,51,51,"events"],[96,8,51,58],[96,9,51,59],[96,10,51,60],[97,8,52,12],[97,14,52,18,"blob"],[97,18,52,22],[97,21,52,25],[97,25,52,29,"Blob"],[97,29,52,33],[97,30,52,34],[97,31,52,35,"beaconPayload"],[97,44,52,48],[97,45,52,49],[97,47,52,51],[98,10,52,53,"type"],[98,14,52,57],[98,16,52,59],[99,8,52,78],[99,9,52,79],[99,10,52,80],[100,8,53,12],[100,15,53,20],[100,22,53,27,"navigator"],[100,31,53,36],[100,36,53,41],[100,47,53,52],[100,51,54,16,"beaconPayload"],[100,64,54,29],[100,65,54,30,"length"],[100,71,54,36],[100,74,54,39],[100,79,54,44],[100,83,55,16],[100,84,55,17,"navigator"],[100,93,55,26],[100,94,55,27,"sendBeacon"],[100,104,55,37],[100,105,55,38,"trackBatchUrl"],[100,118,55,51],[100,120,55,53,"blob"],[100,124,55,57],[100,125,55,58],[101,6,56,8],[101,7,56,9],[101,8,57,8],[101,15,57,15,"_a"],[101,17,57,17],[101,19,57,19],[102,8,58,12],[102,15,58,19],[102,20,58,24],[103,6,59,8],[104,4,60,4],[104,5,60,5],[105,4,61,4],[105,10,61,10,"flush"],[105,15,61,15],[105,18,61,18],[105,24,61,18,"flush"],[105,25,61,25,"eventsData"],[105,35,61,35],[105,37,61,37,"options"],[105,44,61,44],[105,47,61,47],[105,48,61,48],[105,49,61,49],[105,54,61,54],[106,6,62,8],[106,10,62,12,"eventsData"],[106,20,62,22],[106,21,62,23,"length"],[106,27,62,29],[106,32,62,34],[106,33,62,35],[106,35,63,12],[107,6,64,8],[107,12,64,14,"sessionContext_"],[107,27,64,29],[107,30,64,32],[107,36,64,38,"getSessionContext"],[107,53,64,55],[107,54,64,56,"userAuthModule"],[107,68,64,70],[107,69,64,71],[108,6,65,8],[108,12,65,14,"events"],[108,18,65,20],[108,21,65,23,"eventsData"],[108,31,65,33],[108,32,65,34,"map"],[108,35,65,37],[108,36,65,38,"transformEventDataToApiRequestData"],[108,70,65,72],[108,71,65,73,"sessionContext_"],[108,86,65,88],[108,87,65,89],[108,88,65,90],[109,6,66,8],[109,10,66,12],[110,8,67,12],[110,12,67,16],[110,13,67,17,"options"],[110,20,67,24],[110,21,67,25,"isBeacon"],[110,29,67,33],[110,33,67,37],[110,34,67,38,"beaconRequest"],[110,47,67,51],[110,48,67,52,"events"],[110,54,67,58],[110,55,67,59],[110,57,67,61],[111,10,68,16],[111,16,68,22,"batchRequestFallback"],[111,36,68,42],[111,37,68,43,"events"],[111,43,68,49],[111,44,68,50],[112,8,69,12],[113,6,70,8],[113,7,70,9],[113,8,71,8],[113,15,71,15,"_a"],[113,17,71,17],[113,19,71,19],[114,8,72,12],[115,6,72,12],[116,4,74,4],[116,5,74,5],[117,4,75,4],[117,10,75,10,"startProcessing"],[117,25,75,25],[117,28,75,28,"startProcessing"],[117,29,75,28],[117,34,75,34],[118,6,76,8,"startAnalyticsProcessor"],[118,29,76,31],[118,30,76,32,"flush"],[118,35,76,37],[118,37,76,39],[119,8,77,12,"throttleTime"],[119,20,77,24],[120,8,78,12,"batchSize"],[121,6,79,8],[121,7,79,9],[121,8,79,10],[122,4,80,4],[122,5,80,5],[123,4,81,4],[123,10,81,10,"track"],[123,15,81,15],[123,18,81,19,"params"],[123,24,81,25],[123,28,81,30],[124,6,82,8],[124,10,82,12,"analyticsSharedState"],[124,30,82,32],[124,31,82,33,"requestsQueue"],[124,44,82,46],[124,45,82,47,"length"],[124,51,82,53],[124,55,82,57,"maxQueueSize"],[124,67,82,69],[124,69,82,71],[125,8,83,12],[126,6,84,8],[127,6,85,8],[127,12,85,14,"intrinsicData"],[127,25,85,27],[127,28,85,30,"getEventIntrinsicData"],[127,49,85,51],[127,50,85,52],[127,51,85,53],[128,6,86,8,"analyticsSharedState"],[128,26,86,28],[128,27,86,29,"requestsQueue"],[128,40,86,42],[128,41,86,43,"push"],[128,45,86,47],[128,46,86,48],[129,8,87,12],[129,11,87,15,"params"],[129,17,87,21],[130,8,88,12],[130,11,88,15,"intrinsicData"],[131,6,89,8],[131,7,89,9],[131,8,89,10],[132,6,90,8,"startProcessing"],[132,21,90,23],[132,22,90,24],[132,23,90,25],[133,4,91,4],[133,5,91,5],[134,4,92,4],[134,10,92,10,"onDocVisible"],[134,22,92,22],[134,25,92,25,"onDocVisible"],[134,26,92,25],[134,31,92,31],[135,6,93,8,"startAnalyticsProcessor"],[135,29,93,31],[135,30,93,32,"flush"],[135,35,93,37],[135,37,93,39],[136,8,94,12,"throttleTime"],[136,20,94,24],[137,8,95,12,"batchSize"],[138,6,96,8],[138,7,96,9],[138,8,96,10],[139,6,97,8,"clearHeartBeatProcessor"],[139,29,97,31],[139,32,97,34,"startHeartBeatProcessor"],[139,55,97,57],[139,56,97,58,"track"],[139,61,97,63],[139,62,97,64],[140,4,98,4],[140,5,98,5],[141,4,99,4],[141,10,99,10,"onDocHidden"],[141,21,99,21],[141,24,99,24,"onDocHidden"],[141,25,99,24],[141,30,99,30],[142,6,100,8,"stopAnalyticsProcessor"],[142,28,100,30],[142,29,100,31],[142,30,100,32],[143,6,101,8,"clearHeartBeatProcessor"],[143,29,101,31],[143,34,101,36],[143,38,101,40],[143,42,101,44,"clearHeartBeatProcessor"],[143,65,101,67],[143,70,101,72],[143,75,101,77],[143,76,101,78],[143,79,101,81],[143,84,101,86],[143,85,101,87],[143,88,101,90,"clearHeartBeatProcessor"],[143,111,101,113],[143,112,101,114],[143,113,101,115],[144,6,102,8],[145,6,103,8],[145,12,103,14,"eventsData"],[145,22,103,24],[145,25,103,27,"analyticsSharedState"],[145,45,103,47],[145,46,103,48,"requestsQueue"],[145,59,103,61],[145,60,103,62,"splice"],[145,66,103,68],[145,67,103,69],[145,68,103,70],[145,69,103,71],[146,6,104,8,"flush"],[146,11,104,13],[146,12,104,14,"eventsData"],[146,22,104,24],[146,24,104,26],[147,8,104,28,"isBeacon"],[147,16,104,36],[147,18,104,38],[148,6,104,43],[148,7,104,44],[148,8,104,45],[149,4,105,4],[149,5,105,5],[150,4,106,4],[150,10,106,10,"onVisibilityChange"],[150,28,106,28],[150,31,106,31,"onVisibilityChange"],[150,32,106,31],[150,37,106,37],[151,6,107,8],[151,10,107,12],[151,17,107,19,"window"],[151,23,107,25],[151,28,107,30],[151,39,107,41],[151,41,108,12],[152,6,109,8],[152,10,109,12,"document"],[152,18,109,20],[152,19,109,21,"visibilityState"],[152,34,109,36],[152,39,109,41],[152,47,109,49],[152,49,109,51],[153,8,110,12,"onDocHidden"],[153,19,110,23],[153,20,110,24],[153,21,110,25],[154,6,111,8],[154,7,111,9],[154,13,112,13],[154,17,112,17,"document"],[154,25,112,25],[154,26,112,26,"visibilityState"],[154,41,112,41],[154,46,112,46],[154,55,112,55],[154,57,112,57],[155,8,113,12,"onDocVisible"],[155,20,113,24],[155,21,113,25],[155,22,113,26],[156,6,114,8],[157,4,115,4],[157,5,115,5],[158,4,116,4],[158,10,116,10,"cleanup"],[158,17,116,17],[158,20,116,20,"cleanup"],[158,21,116,20],[158,26,116,26],[159,6,117,8,"stopAnalyticsProcessor"],[159,28,117,30],[159,29,117,31],[159,30,117,32],[160,6,118,8,"clearHeartBeatProcessor"],[160,29,118,31],[160,34,118,36],[160,38,118,40],[160,42,118,44,"clearHeartBeatProcessor"],[160,65,118,67],[160,70,118,72],[160,75,118,77],[160,76,118,78],[160,79,118,81],[160,84,118,86],[160,85,118,87],[160,88,118,90,"clearHeartBeatProcessor"],[160,111,118,113],[160,112,118,114],[160,113,118,115],[161,6,119,8],[161,10,119,12],[161,17,119,19,"window"],[161,23,119,25],[161,28,119,30],[161,39,119,41],[161,41,119,43],[162,8,120,12,"window"],[162,14,120,18],[162,15,120,19,"removeEventListener"],[162,34,120,38],[162,35,120,39],[162,53,120,57],[162,55,120,59,"onVisibilityChange"],[162,73,120,77],[162,74,120,78],[163,6,121,8],[164,4,122,4],[164,5,122,5],[165,4,123,4],[166,4,124,4,"startProcessing"],[166,19,124,19],[166,20,124,20],[166,21,124,21],[167,4,125,4],[168,4,126,4,"clearHeartBeatProcessor"],[168,27,126,27],[168,30,126,30,"startHeartBeatProcessor"],[168,53,126,53],[168,54,126,54,"track"],[168,59,126,59],[168,60,126,60],[169,4,127,4],[170,4,128,4],[170,8,128,8],[170,15,128,15,"window"],[170,21,128,21],[170,26,128,26],[170,37,128,37],[170,39,128,39],[171,6,129,8,"window"],[171,12,129,14],[171,13,129,15,"addEventListener"],[171,29,129,31],[171,30,129,32],[171,48,129,50],[171,50,129,52,"onVisibilityChange"],[171,68,129,70],[171,69,129,71],[172,4,130,4],[173,4,131,4],[173,11,131,11],[174,6,132,8,"track"],[174,11,132,13],[175,6,133,8,"cleanup"],[176,4,134,4],[176,5,134,5],[177,2,135,0],[177,3,135,1],[178,2,136,0],[178,11,136,9,"stopAnalyticsProcessor"],[178,33,136,31,"stopAnalyticsProcessor"],[178,34,136,31],[178,36,136,34],[179,4,137,4,"analyticsSharedState"],[179,24,137,24],[179,25,137,25,"isProcessing"],[179,37,137,37],[179,40,137,40],[179,45,137,45],[180,2,138,0],[181,2,139,0],[181,17,139,15,"startAnalyticsProcessor"],[181,40,139,38,"startAnalyticsProcessor"],[181,41,139,39,"handleTrack"],[181,52,139,50],[181,54,139,52,"options"],[181,61,139,59],[181,63,139,61],[182,4,140,4],[182,8,140,8,"analyticsSharedState"],[182,28,140,28],[182,29,140,29,"isProcessing"],[182,41,140,41],[182,43,140,43],[183,6,141,8],[184,6,142,8],[185,4,143,4],[186,4,144,4,"analyticsSharedState"],[186,24,144,24],[186,25,144,25,"isProcessing"],[186,37,144,37],[186,40,144,40],[186,44,144,44],[187,4,145,4],[187,10,145,10],[188,6,145,12,"throttleTime"],[188,18,145,24],[188,21,145,27],[188,25,145,31],[189,6,145,33,"batchSize"],[189,15,145,42],[189,18,145,45],[190,4,145,48],[190,5,145,49],[190,8,145,52,"options"],[190,15,145,59],[190,20,145,64],[190,24,145,68],[190,28,145,72,"options"],[190,35,145,79],[190,40,145,84],[190,45,145,89],[190,46,145,90],[190,49,145,93,"options"],[190,56,145,100],[190,59,145,103],[190,60,145,104],[190,61,145,105],[191,4,146,4],[191,11,146,11,"analyticsSharedState"],[191,31,146,31],[191,32,146,32,"isProcessing"],[191,44,146,44],[191,48,147,8,"analyticsSharedState"],[191,68,147,28],[191,69,147,29,"requestsQueue"],[191,82,147,42],[191,83,147,43,"length"],[191,89,147,49],[191,92,147,52],[191,93,147,53],[191,95,147,55],[192,6,148,8],[192,12,148,14,"requests"],[192,20,148,22],[192,23,148,25,"analyticsSharedState"],[192,43,148,45],[192,44,148,46,"requestsQueue"],[192,57,148,59],[192,58,148,60,"splice"],[192,64,148,66],[192,65,148,67],[192,66,148,68],[192,68,148,70,"batchSize"],[192,77,148,79],[192,78,148,80],[193,6,149,8,"requests"],[193,14,149,16],[193,15,149,17,"length"],[193,21,149,23],[193,26,149,28],[193,32,149,34,"handleTrack"],[193,43,149,45],[193,44,149,46,"requests"],[193,52,149,54],[193,53,149,55],[193,54,149,56],[194,6,150,8],[194,12,150,14],[194,16,150,18,"Promise"],[194,23,150,25],[194,24,150,27,"resolve"],[194,31,150,34],[194,35,150,39,"setTimeout"],[194,45,150,49],[194,46,150,50,"resolve"],[194,53,150,57],[194,55,150,59,"throttleTime"],[194,67,150,71],[194,68,150,72],[194,69,150,73],[195,4,151,4],[196,4,152,4,"analyticsSharedState"],[196,24,152,24],[196,25,152,25,"isProcessing"],[196,37,152,37],[196,40,152,40],[196,45,152,45],[197,2,153,0],[198,2,154,0],[198,11,154,9,"startHeartBeatProcessor"],[198,34,154,32,"startHeartBeatProcessor"],[198,35,154,33,"track"],[198,40,154,38],[198,42,154,40],[199,4,155,4],[199,8,155,8,"_a"],[199,10,155,10],[200,4,156,4],[200,8,156,8,"analyticsSharedState"],[200,28,156,28],[200,29,156,29,"isHeartBeatProcessing"],[200,50,156,50],[200,54,157,8],[200,55,157,9],[200,56,157,10,"_a"],[200,58,157,12],[200,61,157,15,"analyticsSharedState"],[200,81,157,35],[200,82,157,36,"config"],[200,88,157,42],[200,89,157,43,"heartBeatInterval"],[200,106,157,60],[200,112,157,66],[200,116,157,70],[200,120,157,74,"_a"],[200,122,157,76],[200,127,157,81],[200,132,157,86],[200,133,157,87],[200,136,157,90,"_a"],[200,138,157,92],[200,141,157,95],[200,142,157,96],[200,146,157,100],[200,148,157,102],[200,150,157,104],[201,6,158,8],[201,13,158,15],[201,19,158,21],[201,20,158,23],[201,21,158,24],[202,4,159,4],[203,4,160,4,"analyticsSharedState"],[203,24,160,24],[203,25,160,25,"isHeartBeatProcessing"],[203,46,160,46],[203,49,160,49],[203,53,160,53],[204,4,161,4],[204,10,161,10,"interval"],[204,18,161,18],[204,21,161,21,"setInterval"],[204,32,161,32],[204,33,161,33],[204,39,161,39],[205,6,162,8,"track"],[205,11,162,13],[205,12,162,14],[206,8,162,16,"eventName"],[206,17,162,25],[206,19,162,27,"USER_HEARTBEAT_EVENT_NAME"],[207,6,162,53],[207,7,162,54],[207,8,162,55],[208,4,163,4],[208,5,163,5],[208,7,163,7,"analyticsSharedState"],[208,27,163,27],[208,28,163,28,"config"],[208,34,163,34],[208,35,163,35,"heartBeatInterval"],[208,52,163,52],[208,53,163,53],[209,4,164,4],[209,11,164,11],[209,17,164,17],[210,6,165,8,"clearInterval"],[210,19,165,21],[210,20,165,22,"interval"],[210,28,165,30],[210,29,165,31],[211,6,166,8,"analyticsSharedState"],[211,26,166,28],[211,27,166,29,"isHeartBeatProcessing"],[211,48,166,50],[211,51,166,53],[211,56,166,58],[212,4,167,4],[212,5,167,5],[213,2,168,0],[214,2,169,0],[214,11,169,9,"getEventIntrinsicData"],[214,32,169,30,"getEventIntrinsicData"],[214,33,169,30],[214,35,169,33],[215,4,170,4],[215,11,170,11],[216,6,171,8,"timestamp"],[216,15,171,17],[216,17,171,19],[216,21,171,23,"Date"],[216,25,171,27],[216,26,171,28],[216,27,171,29],[216,28,171,30,"toISOString"],[216,39,171,41],[216,40,171,42],[216,41,171,43],[217,6,172,8,"pageUrl"],[217,13,172,15],[217,15,172,17],[217,22,172,24,"window"],[217,28,172,30],[217,33,172,35],[217,44,172,46],[217,47,172,49,"window"],[217,53,172,55],[217,54,172,56,"location"],[217,62,172,64],[217,63,172,65,"pathname"],[217,71,172,73],[217,74,172,76],[218,4,173,4],[218,5,173,5],[219,2,174,0],[220,2,175,0],[220,11,175,9,"transformEventDataToApiRequestData"],[220,45,175,43,"transformEventDataToApiRequestData"],[220,46,175,44,"sessionContext"],[220,60,175,58],[220,62,175,60],[221,4,176,4],[221,11,176,12,"eventData"],[221,20,176,21],[221,25,176,27],[222,6,177,8,"event_name"],[222,16,177,18],[222,18,177,20,"eventData"],[222,27,177,29],[222,28,177,30,"eventName"],[222,37,177,39],[223,6,178,8,"properties"],[223,16,178,18],[223,18,178,20,"eventData"],[223,27,178,29],[223,28,178,30,"properties"],[223,38,178,40],[224,6,179,8,"timestamp"],[224,15,179,17],[224,17,179,19,"eventData"],[224,26,179,28],[224,27,179,29,"timestamp"],[224,36,179,38],[225,6,180,8,"page_url"],[225,14,180,16],[225,16,180,18,"eventData"],[225,25,180,27],[225,26,180,28,"pageUrl"],[225,33,180,35],[226,6,181,8],[226,9,181,11,"sessionContext"],[227,4,182,4],[227,5,182,5],[227,6,182,6],[228,2,183,0],[229,2,184,0],[229,6,184,4,"sessionContextPromise"],[229,27,184,25],[229,30,184,28],[229,34,184,32],[230,2,185,0],[230,17,185,15,"getSessionContext"],[230,34,185,32,"getSessionContext"],[230,35,185,33,"userAuthModule"],[230,49,185,47],[230,51,185,49],[231,4,186,4],[231,8,186,8],[231,9,186,9,"analyticsSharedState"],[231,29,186,29],[231,30,186,30,"sessionContext"],[231,44,186,44],[231,46,186,46],[232,6,187,8],[232,10,187,12],[232,11,187,13,"sessionContextPromise"],[232,32,187,34],[232,34,187,36],[233,8,188,12],[233,14,188,18,"sessionId"],[233,23,188,27],[233,26,188,30,"getAnalyticsSessionId"],[233,47,188,51],[233,48,188,52],[233,49,188,53],[234,8,189,12,"sessionContextPromise"],[234,29,189,33],[234,32,189,36,"userAuthModule"],[234,46,189,50],[234,47,190,17,"me"],[234,49,190,19],[234,50,190,20],[234,51,190,21],[234,52,191,17,"then"],[234,56,191,21],[234,57,191,23,"user"],[234,61,191,27],[234,66,191,33],[235,10,192,16,"user_id"],[235,17,192,23],[235,19,192,25,"user"],[235,23,192,29],[235,24,192,30,"id"],[235,26,192,32],[236,10,193,16,"session_id"],[236,20,193,26],[236,22,193,28,"sessionId"],[237,8,194,12],[237,9,194,13],[237,10,194,14],[237,11,194,15],[237,12,195,17,"catch"],[237,17,195,22],[237,18,195,23],[237,25,195,30],[238,10,196,16,"user_id"],[238,17,196,23],[238,19,196,25],[238,23,196,29],[239,10,197,16,"session_id"],[239,20,197,26],[239,22,197,28,"sessionId"],[240,8,198,12],[240,9,198,13],[240,10,198,14],[240,11,198,15],[241,6,199,8],[242,6,200,8,"analyticsSharedState"],[242,26,200,28],[242,27,200,29,"sessionContext"],[242,41,200,43],[242,44,200,46],[242,50,200,52,"sessionContextPromise"],[242,71,200,73],[243,4,201,4],[244,4,202,4],[244,11,202,11,"analyticsSharedState"],[244,31,202,31],[244,32,202,32,"sessionContext"],[244,46,202,46],[245,2,203,0],[246,2,204,7],[246,11,204,16,"getAnalyticsConfigFromUrlParams"],[246,42,204,47,"getAnalyticsConfigFromUrlParams"],[246,43,204,47],[246,45,204,50],[247,4,205,4],[247,8,205,8],[247,15,205,15,"window"],[247,21,205,21],[247,26,205,26],[247,37,205,37],[247,39,206,8],[247,46,206,15,"undefined"],[247,55,206,24],[248,4,207,4],[248,10,207,10,"urlParams"],[248,19,207,19],[248,22,207,22],[248,26,207,26,"URLSearchParams"],[248,41,207,41],[248,42,207,42,"window"],[248,48,207,48],[248,49,207,49,"location"],[248,57,207,57],[248,58,207,58,"search"],[248,64,207,64],[248,65,207,65],[249,4,208,4],[249,10,208,10,"analyticsEnable"],[249,25,208,25],[249,28,208,28,"urlParams"],[249,37,208,37],[249,38,208,38,"get"],[249,41,208,41],[249,42,208,42,"ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY"],[249,79,208,79],[249,80,208,80],[250,4,209,4],[251,4,210,4],[251,8,210,8,"analyticsEnable"],[251,23,210,23],[251,27,210,27],[251,31,210,31],[251,35,210,35],[251,36,210,36,"analyticsEnable"],[251,51,210,51],[251,52,210,52,"length"],[251,58,210,58],[251,60,211,8],[251,67,211,15,"undefined"],[251,76,211,24],[252,4,212,4],[253,4,213,4],[253,10,213,10,"newUrlParams"],[253,22,213,22],[253,25,213,25],[253,29,213,29,"URLSearchParams"],[253,44,213,44],[253,45,213,45,"window"],[253,51,213,51],[253,52,213,52,"location"],[253,60,213,60],[253,61,213,61,"search"],[253,67,213,67],[253,68,213,68],[254,4,214,4,"newUrlParams"],[254,16,214,16],[254,17,214,17,"delete"],[254,23,214,23],[254,24,214,24,"ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY"],[254,61,214,61],[254,62,214,62],[255,4,215,4],[255,10,215,10,"newUrl"],[255,16,215,16],[255,19,215,19,"window"],[255,25,215,25],[255,26,215,26,"location"],[255,34,215,34],[255,35,215,35,"pathname"],[255,43,215,43],[255,47,216,9,"newUrlParams"],[255,59,216,21],[255,60,216,22,"toString"],[255,68,216,30],[255,69,216,31],[255,70,216,32],[255,73,216,35],[255,76,216,38],[255,79,216,41,"newUrlParams"],[255,91,216,53],[255,92,216,54,"toString"],[255,100,216,62],[255,101,216,63],[255,102,216,64],[255,105,216,67],[255,107,216,69],[255,108,216,70],[256,4,217,4,"window"],[256,10,217,10],[256,11,217,11,"history"],[256,18,217,18],[256,19,217,19,"replaceState"],[256,31,217,31],[256,32,217,32],[256,33,217,33],[256,34,217,34],[256,36,217,36],[256,38,217,38],[256,40,217,40,"newUrl"],[256,46,217,46],[256,47,217,47],[257,4,218,4],[258,4,219,4],[258,11,219,11],[259,6,219,13,"enabled"],[259,13,219,20],[259,15,219,22,"analyticsEnable"],[259,30,219,37],[259,35,219,42],[260,4,219,49],[260,5,219,50],[261,2,220,0],[262,2,221,7],[262,11,221,16,"getAnalyticsSessionId"],[262,32,221,37,"getAnalyticsSessionId"],[262,33,221,37],[262,35,221,40],[263,4,222,4],[263,8,222,8],[263,15,222,15,"window"],[263,21,222,21],[263,26,222,26],[263,37,222,37],[263,39,222,39],[264,6,223,8],[264,13,223,15],[264,17,223,15,"generateUuid"],[264,29,223,27],[264,30,223,27,"generateUuid"],[264,42,223,27],[264,44,223,28],[264,45,223,29],[265,4,224,4],[266,4,225,4],[266,8,225,8],[267,6,226,8],[267,12,226,14,"sessionId"],[267,21,226,23],[267,24,226,26,"localStorage"],[267,36,226,38],[267,37,226,39,"getItem"],[267,44,226,46],[267,45,226,47,"ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY"],[267,83,226,85],[267,84,226,86],[268,6,227,8],[268,10,227,12],[268,11,227,13,"sessionId"],[268,20,227,22],[268,22,227,24],[269,8,228,12],[269,14,228,18,"newSessionId"],[269,26,228,30],[269,29,228,33],[269,33,228,33,"generateUuid"],[269,45,228,45],[269,46,228,45,"generateUuid"],[269,58,228,45],[269,60,228,46],[269,61,228,47],[270,8,229,12,"localStorage"],[270,20,229,24],[270,21,229,25,"setItem"],[270,28,229,32],[270,29,229,33,"ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY"],[270,67,229,71],[270,69,229,73,"newSessionId"],[270,81,229,85],[270,82,229,86],[271,8,230,12],[271,15,230,19,"newSessionId"],[271,27,230,31],[272,6,231,8],[273,6,232,8],[273,13,232,15,"sessionId"],[273,22,232,24],[274,4,233,4],[274,5,233,5],[274,6,234,4],[274,13,234,11,"_a"],[274,15,234,13],[274,17,234,15],[275,6,235,8],[275,13,235,15],[275,17,235,15,"generateUuid"],[275,29,235,27],[275,30,235,27,"generateUuid"],[275,42,235,27],[275,44,235,28],[275,45,235,29],[276,4,236,4],[277,2,237,0],[278,0,237,1],[278,3]],"functionMap":{"names":["<global>","getSharedInstance$argument_1","createAnalyticsModule","track","cleanup","batchRequestFallback","beaconRequest","flush","startProcessing","onDocVisible","onDocHidden","onVisibilityChange","stopAnalyticsProcessor","startAnalyticsProcessor","Promise$argument_0","startHeartBeatProcessor","<anonymous>","setInterval$argument_0","getEventIntrinsicData","transformEventDataToApiRequestData","getSessionContext","userAuthModule.me.then$argument_0","userAuthModule.me.then._catch$argument_0","getAnalyticsConfigFromUrlParams","getAnalyticsSessionId"],"mappings":"AAA;4ECkB;EDS;qCEC;mBCM,SD;qBEC,SF;iCGK;KHM;0BIE;KJW;kBKC;KLa;4BMC;KNK;kBCC;KDU;yBOC;KPM;wBQC;KRM;+BSC;KTS;oBEC;KFM;CFa;AYC;CZE;AaC;0BCW,8CD;CbG;AeC;eCI,SD;iCEG;KFE;WCC;KDG;CfC;AkBC;ClBK;AmBC;WHC;MGM;CnBC;AoBE;sBCM;cDG;uBEC;cFG;CpBK;OuBC;CvBgB;OwBC;CxBgB"},"hasCjsExports":false},"type":"js/module"}]}