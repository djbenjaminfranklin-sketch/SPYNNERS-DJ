{"dependencies":[{"name":"../utils/sharedInstance","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":60,"index":60}}],"key":"fZWaVZXRV+td3A9HZ0+ZfG+s/ro=","exportNames":["*"],"imports":1}},{"name":"../utils/common","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":61},"end":{"line":2,"column":47,"index":108}}],"key":"KsodrK4j9cfxMx/6SogWBqcOsfM=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"USER_HEARTBEAT_EVENT_NAME\", {\n    enumerable: true,\n    get: function () {\n      return USER_HEARTBEAT_EVENT_NAME;\n    }\n  });\n  Object.defineProperty(exports, \"ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY\", {\n    enumerable: true,\n    get: function () {\n      return ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY;\n    }\n  });\n  Object.defineProperty(exports, \"ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY\", {\n    enumerable: true,\n    get: function () {\n      return ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY;\n    }\n  });\n  Object.defineProperty(exports, \"createAnalyticsModule\", {\n    enumerable: true,\n    get: function () {\n      return createAnalyticsModule;\n    }\n  });\n  exports.getAnalyticsConfigFromUrlParams = getAnalyticsConfigFromUrlParams;\n  exports.getAnalyticsSessionId = getAnalyticsSessionId;\n  var _utilsSharedInstance = require(_dependencyMap[0], \"../utils/sharedInstance\");\n  var _utilsCommon = require(_dependencyMap[1], \"../utils/common\");\n  const USER_HEARTBEAT_EVENT_NAME = \"__user_heartbeat_event__\";\n  const ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY = \"analytics-enable\";\n  const ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY = \"base44_analytics_session_id\";\n  const defaultConfiguration = {\n    // default to disabled //\n    enabled: false,\n    maxQueueSize: 1000,\n    throttleTime: 1000,\n    batchSize: 30,\n    heartBeatInterval: 60 * 1000\n  };\n  ///////////////////////////////////////////////\n  //// shared queue for analytics events     ////\n  ///////////////////////////////////////////////\n  const ANALYTICS_SHARED_STATE_NAME = \"analytics\";\n  // shared state//\n  const analyticsSharedState = (0, _utilsSharedInstance.getSharedInstance)(ANALYTICS_SHARED_STATE_NAME, () => ({\n    requestsQueue: [],\n    isProcessing: false,\n    isHeartBeatProcessing: false,\n    sessionContext: null,\n    config: Object.assign({}, defaultConfiguration, getAnalyticsConfigFromUrlParams())\n  }));\n  const createAnalyticsModule = ({\n    axiosClient,\n    serverUrl,\n    appId,\n    userAuthModule\n  }) => {\n    var _a;\n    // prevent overflow of events //\n    const {\n      maxQueueSize,\n      throttleTime,\n      batchSize\n    } = analyticsSharedState.config;\n    if (!((_a = analyticsSharedState.config) === null || _a === void 0 ? void 0 : _a.enabled)) {\n      return {\n        track: () => {},\n        cleanup: () => {}\n      };\n    }\n    let clearHeartBeatProcessor = undefined;\n    const trackBatchUrl = `${serverUrl}/api/apps/${appId}/analytics/track/batch`;\n    const batchRequestFallback = async events => {\n      await axiosClient.request({\n        method: \"POST\",\n        url: `/apps/${appId}/analytics/track/batch`,\n        data: {\n          events\n        }\n      });\n    };\n    // currently disabled, until fully tested  //\n    const beaconRequest = events => {\n      try {\n        const beaconPayload = JSON.stringify({\n          events\n        });\n        const blob = new Blob([beaconPayload], {\n          type: \"application/json\"\n        });\n        return typeof navigator === \"undefined\" || beaconPayload.length > 60000 || !navigator.sendBeacon(trackBatchUrl, blob);\n      } catch (_a) {\n        return false;\n      }\n    };\n    const flush = async (eventsData, options = {}) => {\n      if (eventsData.length === 0) return;\n      const sessionContext_ = await getSessionContext(userAuthModule);\n      const events = eventsData.map(transformEventDataToApiRequestData(sessionContext_));\n      try {\n        if (!options.isBeacon || !beaconRequest(events)) {\n          await batchRequestFallback(events);\n        }\n      } catch (_a) {\n        // do nothing\n      }\n    };\n    const startProcessing = () => {\n      startAnalyticsProcessor(flush, {\n        throttleTime,\n        batchSize\n      });\n    };\n    const track = params => {\n      if (analyticsSharedState.requestsQueue.length >= maxQueueSize) {\n        return;\n      }\n      const intrinsicData = getEventIntrinsicData();\n      analyticsSharedState.requestsQueue.push(Object.assign({}, params, intrinsicData));\n      startProcessing();\n    };\n    const onDocVisible = () => {\n      startAnalyticsProcessor(flush, {\n        throttleTime,\n        batchSize\n      });\n      clearHeartBeatProcessor = startHeartBeatProcessor(track);\n    };\n    const onDocHidden = () => {\n      stopAnalyticsProcessor();\n      clearHeartBeatProcessor === null || clearHeartBeatProcessor === void 0 ? void 0 : clearHeartBeatProcessor();\n      //  flush entire queue on visibility change and hope for the best //\n      const eventsData = analyticsSharedState.requestsQueue.splice(0);\n      flush(eventsData, {\n        isBeacon: true\n      });\n    };\n    const onVisibilityChange = () => {\n      if (typeof window === \"undefined\") return;\n      if (document.visibilityState === \"hidden\") {\n        onDocHidden();\n      } else if (document.visibilityState === \"visible\") {\n        onDocVisible();\n      }\n    };\n    const cleanup = () => {\n      stopAnalyticsProcessor();\n      clearHeartBeatProcessor === null || clearHeartBeatProcessor === void 0 ? void 0 : clearHeartBeatProcessor();\n      if (typeof window !== \"undefined\") {\n        window.removeEventListener(\"visibilitychange\", onVisibilityChange);\n      }\n    };\n    // start the flusing process ///\n    startProcessing();\n    // start the heart beat processor //\n    clearHeartBeatProcessor = startHeartBeatProcessor(track);\n    // start the visibility change listener //\n    if (typeof window !== \"undefined\") {\n      window.addEventListener(\"visibilitychange\", onVisibilityChange);\n    }\n    return {\n      track,\n      cleanup\n    };\n  };\n  function stopAnalyticsProcessor() {\n    analyticsSharedState.isProcessing = false;\n  }\n  async function startAnalyticsProcessor(handleTrack, options) {\n    if (analyticsSharedState.isProcessing) {\n      // only one instance of the analytics processor can be running at a time //\n      return;\n    }\n    analyticsSharedState.isProcessing = true;\n    const {\n      throttleTime = 1000,\n      batchSize = 30\n    } = options !== null && options !== void 0 ? options : {};\n    while (analyticsSharedState.isProcessing && analyticsSharedState.requestsQueue.length > 0) {\n      const requests = analyticsSharedState.requestsQueue.splice(0, batchSize);\n      requests.length && (await handleTrack(requests));\n      await new Promise(resolve => setTimeout(resolve, throttleTime));\n    }\n    analyticsSharedState.isProcessing = false;\n  }\n  function startHeartBeatProcessor(track) {\n    var _a;\n    if (analyticsSharedState.isHeartBeatProcessing || ((_a = analyticsSharedState.config.heartBeatInterval) !== null && _a !== void 0 ? _a : 0) < 10) {\n      return () => {};\n    }\n    analyticsSharedState.isHeartBeatProcessing = true;\n    const interval = setInterval(() => {\n      track({\n        eventName: USER_HEARTBEAT_EVENT_NAME\n      });\n    }, analyticsSharedState.config.heartBeatInterval);\n    return () => {\n      clearInterval(interval);\n      analyticsSharedState.isHeartBeatProcessing = false;\n    };\n  }\n  function getEventIntrinsicData() {\n    return {\n      timestamp: new Date().toISOString(),\n      pageUrl: typeof window !== \"undefined\" ? window.location.pathname : null\n    };\n  }\n  function transformEventDataToApiRequestData(sessionContext) {\n    return eventData => Object.assign({\n      event_name: eventData.eventName,\n      properties: eventData.properties,\n      timestamp: eventData.timestamp,\n      page_url: eventData.pageUrl\n    }, sessionContext);\n  }\n  let sessionContextPromise = null;\n  async function getSessionContext(userAuthModule) {\n    if (!analyticsSharedState.sessionContext) {\n      if (!sessionContextPromise) {\n        const sessionId = getAnalyticsSessionId();\n        sessionContextPromise = userAuthModule.me().then(user => ({\n          user_id: user.id,\n          session_id: sessionId\n        })).catch(() => ({\n          user_id: null,\n          session_id: sessionId\n        }));\n      }\n      analyticsSharedState.sessionContext = await sessionContextPromise;\n    }\n    return analyticsSharedState.sessionContext;\n  }\n  function getAnalyticsConfigFromUrlParams() {\n    if (typeof window === \"undefined\") return undefined;\n    const urlParams = new URLSearchParams(window.location.search);\n    const analyticsEnable = urlParams.get(ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY);\n    // if the url param is not set, return undefined //\n    if (analyticsEnable == null || !analyticsEnable.length) return undefined;\n    // remove the url param from the url //\n    const newUrlParams = new URLSearchParams(window.location.search);\n    newUrlParams.delete(ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY);\n    const newUrl = window.location.pathname + (newUrlParams.toString() ? \"?\" + newUrlParams.toString() : \"\");\n    window.history.replaceState({}, \"\", newUrl);\n    // return the config object //\n    return {\n      enabled: analyticsEnable === \"true\"\n    };\n  }\n  function getAnalyticsSessionId() {\n    if (typeof window === \"undefined\") {\n      return (0, _utilsCommon.generateUuid)();\n    }\n    try {\n      const sessionId = localStorage.getItem(ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY);\n      if (!sessionId) {\n        const newSessionId = (0, _utilsCommon.generateUuid)();\n        localStorage.setItem(ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY, newSessionId);\n        return newSessionId;\n      }\n      return sessionId;\n    } catch (_a) {\n      return (0, _utilsCommon.generateUuid)();\n    }\n  }\n});","lineCount":271,"map":[[7,2,3,0,"Object"],[7,8,3,0],[7,9,3,0,"defineProperty"],[7,23,3,0],[7,24,3,0,"exports"],[7,31,3,0],[8,4,3,0,"enumerable"],[8,14,3,0],[9,4,3,0,"get"],[9,7,3,0],[9,18,3,0,"get"],[9,19,3,0],[10,6,3,0],[10,13,3,0,"USER_HEARTBEAT_EVENT_NAME"],[10,38,3,0],[11,4,3,0],[12,2,3,0],[13,2,4,0,"Object"],[13,8,4,0],[13,9,4,0,"defineProperty"],[13,23,4,0],[13,24,4,0,"exports"],[13,31,4,0],[14,4,4,0,"enumerable"],[14,14,4,0],[15,4,4,0,"get"],[15,7,4,0],[15,18,4,0,"get"],[15,19,4,0],[16,6,4,0],[16,13,4,0,"ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY"],[16,50,4,0],[17,4,4,0],[18,2,4,0],[19,2,5,0,"Object"],[19,8,5,0],[19,9,5,0,"defineProperty"],[19,23,5,0],[19,24,5,0,"exports"],[19,31,5,0],[20,4,5,0,"enumerable"],[20,14,5,0],[21,4,5,0,"get"],[21,7,5,0],[21,18,5,0,"get"],[21,19,5,0],[22,6,5,0],[22,13,5,0,"ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY"],[22,51,5,0],[23,4,5,0],[24,2,5,0],[25,2,29,0,"Object"],[25,8,29,0],[25,9,29,0,"defineProperty"],[25,23,29,0],[25,24,29,0,"exports"],[25,31,29,0],[26,4,29,0,"enumerable"],[26,14,29,0],[27,4,29,0,"get"],[27,7,29,0],[27,18,29,0,"get"],[27,19,29,0],[28,6,29,0],[28,13,29,0,"createAnalyticsModule"],[28,34,29,0],[29,4,29,0],[30,2,29,0],[31,2,204,0,"exports"],[31,9,204,0],[31,10,204,0,"getAnalyticsConfigFromUrlParams"],[31,41,204,0],[31,44,204,0,"getAnalyticsConfigFromUrlParams"],[31,75,204,0],[32,2,221,0,"exports"],[32,9,221,0],[32,10,221,0,"getAnalyticsSessionId"],[32,31,221,0],[32,34,221,0,"getAnalyticsSessionId"],[32,55,221,0],[33,2,1,0],[33,6,1,0,"_utilsSharedInstance"],[33,26,1,0],[33,29,1,0,"require"],[33,36,1,0],[33,37,1,0,"_dependencyMap"],[33,51,1,0],[34,2,2,0],[34,6,2,0,"_utilsCommon"],[34,18,2,0],[34,21,2,0,"require"],[34,28,2,0],[34,29,2,0,"_dependencyMap"],[34,43,2,0],[35,2,3,7],[35,8,3,13,"USER_HEARTBEAT_EVENT_NAME"],[35,33,3,38],[35,36,3,41],[35,62,3,67],[36,2,4,7],[36,8,4,13,"ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY"],[36,45,4,50],[36,48,4,53],[36,66,4,71],[37,2,5,7],[37,8,5,13,"ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY"],[37,46,5,51],[37,49,5,54],[37,78,5,83],[38,2,6,0],[38,8,6,6,"defaultConfiguration"],[38,28,6,26],[38,31,6,29],[39,4,7,4],[40,4,8,4,"enabled"],[40,11,8,11],[40,13,8,13],[40,18,8,18],[41,4,9,4,"maxQueueSize"],[41,16,9,16],[41,18,9,18],[41,22,9,22],[42,4,10,4,"throttleTime"],[42,16,10,16],[42,18,10,18],[42,22,10,22],[43,4,11,4,"batchSize"],[43,13,11,13],[43,15,11,15],[43,17,11,17],[44,4,12,4,"heartBeatInterval"],[44,21,12,21],[44,23,12,23],[44,25,12,25],[44,28,12,28],[45,2,13,0],[45,3,13,1],[46,2,14,0],[47,2,15,0],[48,2,16,0],[49,2,17,0],[49,8,17,6,"ANALYTICS_SHARED_STATE_NAME"],[49,35,17,33],[49,38,17,36],[49,49,17,47],[50,2,18,0],[51,2,19,0],[51,8,19,6,"analyticsSharedState"],[51,28,19,26],[51,31,19,29],[51,35,19,29,"getSharedInstance"],[51,55,19,46],[51,56,19,46,"getSharedInstance"],[51,73,19,46],[51,75,19,47,"ANALYTICS_SHARED_STATE_NAME"],[51,102,19,74],[51,104,19,76],[51,111,19,83],[52,4,20,4,"requestsQueue"],[52,17,20,17],[52,19,20,19],[52,21,20,21],[53,4,21,4,"isProcessing"],[53,16,21,16],[53,18,21,18],[53,23,21,23],[54,4,22,4,"isHeartBeatProcessing"],[54,25,22,25],[54,27,22,27],[54,32,22,32],[55,4,23,4,"sessionContext"],[55,18,23,18],[55,20,23,20],[55,24,23,24],[56,4,24,4,"config"],[56,10,24,10],[56,12,24,10,"Object"],[56,18,24,10],[56,19,24,10,"assign"],[56,25,24,10],[56,30,25,11,"defaultConfiguration"],[56,50,25,31],[56,52,26,11,"getAnalyticsConfigFromUrlParams"],[56,83,26,42],[56,84,26,43],[56,85,26,44],[57,2,28,0],[57,3,28,1],[57,4,28,2],[57,5,28,3],[58,2,29,7],[58,8,29,13,"createAnalyticsModule"],[58,29,29,34],[58,32,29,37,"createAnalyticsModule"],[58,33,29,38],[59,4,29,40,"axiosClient"],[59,15,29,51],[60,4,29,53,"serverUrl"],[60,13,29,62],[61,4,29,64,"appId"],[61,9,29,69],[62,4,29,71,"userAuthModule"],[63,2,29,87],[63,3,29,88],[63,8,29,93],[64,4,30,4],[64,8,30,8,"_a"],[64,10,30,10],[65,4,31,4],[66,4,32,4],[66,10,32,10],[67,6,32,12,"maxQueueSize"],[67,18,32,24],[68,6,32,26,"throttleTime"],[68,18,32,38],[69,6,32,40,"batchSize"],[70,4,32,50],[70,5,32,51],[70,8,32,54,"analyticsSharedState"],[70,28,32,74],[70,29,32,75,"config"],[70,35,32,81],[71,4,33,4],[71,8,33,8],[71,10,33,10],[71,11,33,11,"_a"],[71,13,33,13],[71,16,33,16,"analyticsSharedState"],[71,36,33,36],[71,37,33,37,"config"],[71,43,33,43],[71,49,33,49],[71,53,33,53],[71,57,33,57,"_a"],[71,59,33,59],[71,64,33,64],[71,69,33,69],[71,70,33,70],[71,73,33,73],[71,78,33,78],[71,79,33,79],[71,82,33,82,"_a"],[71,84,33,84],[71,85,33,85,"enabled"],[71,92,33,92],[71,93,33,93],[71,95,33,95],[72,6,34,8],[72,13,34,15],[73,8,35,12,"track"],[73,13,35,17],[73,15,35,19,"track"],[73,16,35,19],[73,21,35,25],[73,22,35,27],[73,23,35,28],[74,8,36,12,"cleanup"],[74,15,36,19],[74,17,36,21,"cleanup"],[74,18,36,21],[74,23,36,27],[74,24,36,29],[75,6,37,8],[75,7,37,9],[76,4,38,4],[77,4,39,4],[77,8,39,8,"clearHeartBeatProcessor"],[77,31,39,31],[77,34,39,34,"undefined"],[77,43,39,43],[78,4,40,4],[78,10,40,10,"trackBatchUrl"],[78,23,40,23],[78,26,40,26],[78,29,40,29,"serverUrl"],[78,38,40,38],[78,51,40,51,"appId"],[78,56,40,56],[78,80,40,80],[79,4,41,4],[79,10,41,10,"batchRequestFallback"],[79,30,41,30],[79,33,41,33],[79,39,41,40,"events"],[79,45,41,46],[79,49,41,51],[80,6,42,8],[80,12,42,14,"axiosClient"],[80,23,42,25],[80,24,42,26,"request"],[80,31,42,33],[80,32,42,34],[81,8,43,12,"method"],[81,14,43,18],[81,16,43,20],[81,22,43,26],[82,8,44,12,"url"],[82,11,44,15],[82,13,44,17],[82,22,44,26,"appId"],[82,27,44,31],[82,51,44,55],[83,8,45,12,"data"],[83,12,45,16],[83,14,45,18],[84,10,45,20,"events"],[85,8,45,27],[86,6,46,8],[86,7,46,9],[86,8,46,10],[87,4,47,4],[87,5,47,5],[88,4,48,4],[89,4,49,4],[89,10,49,10,"beaconRequest"],[89,23,49,23],[89,26,49,27,"events"],[89,32,49,33],[89,36,49,38],[90,6,50,8],[90,10,50,12],[91,8,51,12],[91,14,51,18,"beaconPayload"],[91,27,51,31],[91,30,51,34,"JSON"],[91,34,51,38],[91,35,51,39,"stringify"],[91,44,51,48],[91,45,51,49],[92,10,51,51,"events"],[93,8,51,58],[93,9,51,59],[93,10,51,60],[94,8,52,12],[94,14,52,18,"blob"],[94,18,52,22],[94,21,52,25],[94,25,52,29,"Blob"],[94,29,52,33],[94,30,52,34],[94,31,52,35,"beaconPayload"],[94,44,52,48],[94,45,52,49],[94,47,52,51],[95,10,52,53,"type"],[95,14,52,57],[95,16,52,59],[96,8,52,78],[96,9,52,79],[96,10,52,80],[97,8,53,12],[97,15,53,20],[97,22,53,27,"navigator"],[97,31,53,36],[97,36,53,41],[97,47,53,52],[97,51,54,16,"beaconPayload"],[97,64,54,29],[97,65,54,30,"length"],[97,71,54,36],[97,74,54,39],[97,79,54,44],[97,83,55,16],[97,84,55,17,"navigator"],[97,93,55,26],[97,94,55,27,"sendBeacon"],[97,104,55,37],[97,105,55,38,"trackBatchUrl"],[97,118,55,51],[97,120,55,53,"blob"],[97,124,55,57],[97,125,55,58],[98,6,56,8],[98,7,56,9],[98,8,57,8],[98,15,57,15,"_a"],[98,17,57,17],[98,19,57,19],[99,8,58,12],[99,15,58,19],[99,20,58,24],[100,6,59,8],[101,4,60,4],[101,5,60,5],[102,4,61,4],[102,10,61,10,"flush"],[102,15,61,15],[102,18,61,18],[102,24,61,18,"flush"],[102,25,61,25,"eventsData"],[102,35,61,35],[102,37,61,37,"options"],[102,44,61,44],[102,47,61,47],[102,48,61,48],[102,49,61,49],[102,54,61,54],[103,6,62,8],[103,10,62,12,"eventsData"],[103,20,62,22],[103,21,62,23,"length"],[103,27,62,29],[103,32,62,34],[103,33,62,35],[103,35,63,12],[104,6,64,8],[104,12,64,14,"sessionContext_"],[104,27,64,29],[104,30,64,32],[104,36,64,38,"getSessionContext"],[104,53,64,55],[104,54,64,56,"userAuthModule"],[104,68,64,70],[104,69,64,71],[105,6,65,8],[105,12,65,14,"events"],[105,18,65,20],[105,21,65,23,"eventsData"],[105,31,65,33],[105,32,65,34,"map"],[105,35,65,37],[105,36,65,38,"transformEventDataToApiRequestData"],[105,70,65,72],[105,71,65,73,"sessionContext_"],[105,86,65,88],[105,87,65,89],[105,88,65,90],[106,6,66,8],[106,10,66,12],[107,8,67,12],[107,12,67,16],[107,13,67,17,"options"],[107,20,67,24],[107,21,67,25,"isBeacon"],[107,29,67,33],[107,33,67,37],[107,34,67,38,"beaconRequest"],[107,47,67,51],[107,48,67,52,"events"],[107,54,67,58],[107,55,67,59],[107,57,67,61],[108,10,68,16],[108,16,68,22,"batchRequestFallback"],[108,36,68,42],[108,37,68,43,"events"],[108,43,68,49],[108,44,68,50],[109,8,69,12],[110,6,70,8],[110,7,70,9],[110,8,71,8],[110,15,71,15,"_a"],[110,17,71,17],[110,19,71,19],[111,8,72,12],[112,6,72,12],[113,4,74,4],[113,5,74,5],[114,4,75,4],[114,10,75,10,"startProcessing"],[114,25,75,25],[114,28,75,28,"startProcessing"],[114,29,75,28],[114,34,75,34],[115,6,76,8,"startAnalyticsProcessor"],[115,29,76,31],[115,30,76,32,"flush"],[115,35,76,37],[115,37,76,39],[116,8,77,12,"throttleTime"],[116,20,77,24],[117,8,78,12,"batchSize"],[118,6,79,8],[118,7,79,9],[118,8,79,10],[119,4,80,4],[119,5,80,5],[120,4,81,4],[120,10,81,10,"track"],[120,15,81,15],[120,18,81,19,"params"],[120,24,81,25],[120,28,81,30],[121,6,82,8],[121,10,82,12,"analyticsSharedState"],[121,30,82,32],[121,31,82,33,"requestsQueue"],[121,44,82,46],[121,45,82,47,"length"],[121,51,82,53],[121,55,82,57,"maxQueueSize"],[121,67,82,69],[121,69,82,71],[122,8,83,12],[123,6,84,8],[124,6,85,8],[124,12,85,14,"intrinsicData"],[124,25,85,27],[124,28,85,30,"getEventIntrinsicData"],[124,49,85,51],[124,50,85,52],[124,51,85,53],[125,6,86,8,"analyticsSharedState"],[125,26,86,28],[125,27,86,29,"requestsQueue"],[125,40,86,42],[125,41,86,43,"push"],[125,45,86,47],[125,46,86,47,"Object"],[125,52,86,47],[125,53,86,47,"assign"],[125,59,86,47],[125,64,87,15,"params"],[125,70,87,21],[125,72,88,15,"intrinsicData"],[125,85,88,28],[125,86,89,9],[125,87,89,10],[126,6,90,8,"startProcessing"],[126,21,90,23],[126,22,90,24],[126,23,90,25],[127,4,91,4],[127,5,91,5],[128,4,92,4],[128,10,92,10,"onDocVisible"],[128,22,92,22],[128,25,92,25,"onDocVisible"],[128,26,92,25],[128,31,92,31],[129,6,93,8,"startAnalyticsProcessor"],[129,29,93,31],[129,30,93,32,"flush"],[129,35,93,37],[129,37,93,39],[130,8,94,12,"throttleTime"],[130,20,94,24],[131,8,95,12,"batchSize"],[132,6,96,8],[132,7,96,9],[132,8,96,10],[133,6,97,8,"clearHeartBeatProcessor"],[133,29,97,31],[133,32,97,34,"startHeartBeatProcessor"],[133,55,97,57],[133,56,97,58,"track"],[133,61,97,63],[133,62,97,64],[134,4,98,4],[134,5,98,5],[135,4,99,4],[135,10,99,10,"onDocHidden"],[135,21,99,21],[135,24,99,24,"onDocHidden"],[135,25,99,24],[135,30,99,30],[136,6,100,8,"stopAnalyticsProcessor"],[136,28,100,30],[136,29,100,31],[136,30,100,32],[137,6,101,8,"clearHeartBeatProcessor"],[137,29,101,31],[137,34,101,36],[137,38,101,40],[137,42,101,44,"clearHeartBeatProcessor"],[137,65,101,67],[137,70,101,72],[137,75,101,77],[137,76,101,78],[137,79,101,81],[137,84,101,86],[137,85,101,87],[137,88,101,90,"clearHeartBeatProcessor"],[137,111,101,113],[137,112,101,114],[137,113,101,115],[138,6,102,8],[139,6,103,8],[139,12,103,14,"eventsData"],[139,22,103,24],[139,25,103,27,"analyticsSharedState"],[139,45,103,47],[139,46,103,48,"requestsQueue"],[139,59,103,61],[139,60,103,62,"splice"],[139,66,103,68],[139,67,103,69],[139,68,103,70],[139,69,103,71],[140,6,104,8,"flush"],[140,11,104,13],[140,12,104,14,"eventsData"],[140,22,104,24],[140,24,104,26],[141,8,104,28,"isBeacon"],[141,16,104,36],[141,18,104,38],[142,6,104,43],[142,7,104,44],[142,8,104,45],[143,4,105,4],[143,5,105,5],[144,4,106,4],[144,10,106,10,"onVisibilityChange"],[144,28,106,28],[144,31,106,31,"onVisibilityChange"],[144,32,106,31],[144,37,106,37],[145,6,107,8],[145,10,107,12],[145,17,107,19,"window"],[145,23,107,25],[145,28,107,30],[145,39,107,41],[145,41,108,12],[146,6,109,8],[146,10,109,12,"document"],[146,18,109,20],[146,19,109,21,"visibilityState"],[146,34,109,36],[146,39,109,41],[146,47,109,49],[146,49,109,51],[147,8,110,12,"onDocHidden"],[147,19,110,23],[147,20,110,24],[147,21,110,25],[148,6,111,8],[148,7,111,9],[148,13,112,13],[148,17,112,17,"document"],[148,25,112,25],[148,26,112,26,"visibilityState"],[148,41,112,41],[148,46,112,46],[148,55,112,55],[148,57,112,57],[149,8,113,12,"onDocVisible"],[149,20,113,24],[149,21,113,25],[149,22,113,26],[150,6,114,8],[151,4,115,4],[151,5,115,5],[152,4,116,4],[152,10,116,10,"cleanup"],[152,17,116,17],[152,20,116,20,"cleanup"],[152,21,116,20],[152,26,116,26],[153,6,117,8,"stopAnalyticsProcessor"],[153,28,117,30],[153,29,117,31],[153,30,117,32],[154,6,118,8,"clearHeartBeatProcessor"],[154,29,118,31],[154,34,118,36],[154,38,118,40],[154,42,118,44,"clearHeartBeatProcessor"],[154,65,118,67],[154,70,118,72],[154,75,118,77],[154,76,118,78],[154,79,118,81],[154,84,118,86],[154,85,118,87],[154,88,118,90,"clearHeartBeatProcessor"],[154,111,118,113],[154,112,118,114],[154,113,118,115],[155,6,119,8],[155,10,119,12],[155,17,119,19,"window"],[155,23,119,25],[155,28,119,30],[155,39,119,41],[155,41,119,43],[156,8,120,12,"window"],[156,14,120,18],[156,15,120,19,"removeEventListener"],[156,34,120,38],[156,35,120,39],[156,53,120,57],[156,55,120,59,"onVisibilityChange"],[156,73,120,77],[156,74,120,78],[157,6,121,8],[158,4,122,4],[158,5,122,5],[159,4,123,4],[160,4,124,4,"startProcessing"],[160,19,124,19],[160,20,124,20],[160,21,124,21],[161,4,125,4],[162,4,126,4,"clearHeartBeatProcessor"],[162,27,126,27],[162,30,126,30,"startHeartBeatProcessor"],[162,53,126,53],[162,54,126,54,"track"],[162,59,126,59],[162,60,126,60],[163,4,127,4],[164,4,128,4],[164,8,128,8],[164,15,128,15,"window"],[164,21,128,21],[164,26,128,26],[164,37,128,37],[164,39,128,39],[165,6,129,8,"window"],[165,12,129,14],[165,13,129,15,"addEventListener"],[165,29,129,31],[165,30,129,32],[165,48,129,50],[165,50,129,52,"onVisibilityChange"],[165,68,129,70],[165,69,129,71],[166,4,130,4],[167,4,131,4],[167,11,131,11],[168,6,132,8,"track"],[168,11,132,13],[169,6,133,8,"cleanup"],[170,4,134,4],[170,5,134,5],[171,2,135,0],[171,3,135,1],[172,2,136,0],[172,11,136,9,"stopAnalyticsProcessor"],[172,33,136,31,"stopAnalyticsProcessor"],[172,34,136,31],[172,36,136,34],[173,4,137,4,"analyticsSharedState"],[173,24,137,24],[173,25,137,25,"isProcessing"],[173,37,137,37],[173,40,137,40],[173,45,137,45],[174,2,138,0],[175,2,139,0],[175,17,139,15,"startAnalyticsProcessor"],[175,40,139,38,"startAnalyticsProcessor"],[175,41,139,39,"handleTrack"],[175,52,139,50],[175,54,139,52,"options"],[175,61,139,59],[175,63,139,61],[176,4,140,4],[176,8,140,8,"analyticsSharedState"],[176,28,140,28],[176,29,140,29,"isProcessing"],[176,41,140,41],[176,43,140,43],[177,6,141,8],[178,6,142,8],[179,4,143,4],[180,4,144,4,"analyticsSharedState"],[180,24,144,24],[180,25,144,25,"isProcessing"],[180,37,144,37],[180,40,144,40],[180,44,144,44],[181,4,145,4],[181,10,145,10],[182,6,145,12,"throttleTime"],[182,18,145,24],[182,21,145,27],[182,25,145,31],[183,6,145,33,"batchSize"],[183,15,145,42],[183,18,145,45],[184,4,145,48],[184,5,145,49],[184,8,145,52,"options"],[184,15,145,59],[184,20,145,64],[184,24,145,68],[184,28,145,72,"options"],[184,35,145,79],[184,40,145,84],[184,45,145,89],[184,46,145,90],[184,49,145,93,"options"],[184,56,145,100],[184,59,145,103],[184,60,145,104],[184,61,145,105],[185,4,146,4],[185,11,146,11,"analyticsSharedState"],[185,31,146,31],[185,32,146,32,"isProcessing"],[185,44,146,44],[185,48,147,8,"analyticsSharedState"],[185,68,147,28],[185,69,147,29,"requestsQueue"],[185,82,147,42],[185,83,147,43,"length"],[185,89,147,49],[185,92,147,52],[185,93,147,53],[185,95,147,55],[186,6,148,8],[186,12,148,14,"requests"],[186,20,148,22],[186,23,148,25,"analyticsSharedState"],[186,43,148,45],[186,44,148,46,"requestsQueue"],[186,57,148,59],[186,58,148,60,"splice"],[186,64,148,66],[186,65,148,67],[186,66,148,68],[186,68,148,70,"batchSize"],[186,77,148,79],[186,78,148,80],[187,6,149,8,"requests"],[187,14,149,16],[187,15,149,17,"length"],[187,21,149,23],[187,26,149,28],[187,32,149,34,"handleTrack"],[187,43,149,45],[187,44,149,46,"requests"],[187,52,149,54],[187,53,149,55],[187,54,149,56],[188,6,150,8],[188,12,150,14],[188,16,150,18,"Promise"],[188,23,150,25],[188,24,150,27,"resolve"],[188,31,150,34],[188,35,150,39,"setTimeout"],[188,45,150,49],[188,46,150,50,"resolve"],[188,53,150,57],[188,55,150,59,"throttleTime"],[188,67,150,71],[188,68,150,72],[188,69,150,73],[189,4,151,4],[190,4,152,4,"analyticsSharedState"],[190,24,152,24],[190,25,152,25,"isProcessing"],[190,37,152,37],[190,40,152,40],[190,45,152,45],[191,2,153,0],[192,2,154,0],[192,11,154,9,"startHeartBeatProcessor"],[192,34,154,32,"startHeartBeatProcessor"],[192,35,154,33,"track"],[192,40,154,38],[192,42,154,40],[193,4,155,4],[193,8,155,8,"_a"],[193,10,155,10],[194,4,156,4],[194,8,156,8,"analyticsSharedState"],[194,28,156,28],[194,29,156,29,"isHeartBeatProcessing"],[194,50,156,50],[194,54,157,8],[194,55,157,9],[194,56,157,10,"_a"],[194,58,157,12],[194,61,157,15,"analyticsSharedState"],[194,81,157,35],[194,82,157,36,"config"],[194,88,157,42],[194,89,157,43,"heartBeatInterval"],[194,106,157,60],[194,112,157,66],[194,116,157,70],[194,120,157,74,"_a"],[194,122,157,76],[194,127,157,81],[194,132,157,86],[194,133,157,87],[194,136,157,90,"_a"],[194,138,157,92],[194,141,157,95],[194,142,157,96],[194,146,157,100],[194,148,157,102],[194,150,157,104],[195,6,158,8],[195,13,158,15],[195,19,158,21],[195,20,158,23],[195,21,158,24],[196,4,159,4],[197,4,160,4,"analyticsSharedState"],[197,24,160,24],[197,25,160,25,"isHeartBeatProcessing"],[197,46,160,46],[197,49,160,49],[197,53,160,53],[198,4,161,4],[198,10,161,10,"interval"],[198,18,161,18],[198,21,161,21,"setInterval"],[198,32,161,32],[198,33,161,33],[198,39,161,39],[199,6,162,8,"track"],[199,11,162,13],[199,12,162,14],[200,8,162,16,"eventName"],[200,17,162,25],[200,19,162,27,"USER_HEARTBEAT_EVENT_NAME"],[201,6,162,53],[201,7,162,54],[201,8,162,55],[202,4,163,4],[202,5,163,5],[202,7,163,7,"analyticsSharedState"],[202,27,163,27],[202,28,163,28,"config"],[202,34,163,34],[202,35,163,35,"heartBeatInterval"],[202,52,163,52],[202,53,163,53],[203,4,164,4],[203,11,164,11],[203,17,164,17],[204,6,165,8,"clearInterval"],[204,19,165,21],[204,20,165,22,"interval"],[204,28,165,30],[204,29,165,31],[205,6,166,8,"analyticsSharedState"],[205,26,166,28],[205,27,166,29,"isHeartBeatProcessing"],[205,48,166,50],[205,51,166,53],[205,56,166,58],[206,4,167,4],[206,5,167,5],[207,2,168,0],[208,2,169,0],[208,11,169,9,"getEventIntrinsicData"],[208,32,169,30,"getEventIntrinsicData"],[208,33,169,30],[208,35,169,33],[209,4,170,4],[209,11,170,11],[210,6,171,8,"timestamp"],[210,15,171,17],[210,17,171,19],[210,21,171,23,"Date"],[210,25,171,27],[210,26,171,28],[210,27,171,29],[210,28,171,30,"toISOString"],[210,39,171,41],[210,40,171,42],[210,41,171,43],[211,6,172,8,"pageUrl"],[211,13,172,15],[211,15,172,17],[211,22,172,24,"window"],[211,28,172,30],[211,33,172,35],[211,44,172,46],[211,47,172,49,"window"],[211,53,172,55],[211,54,172,56,"location"],[211,62,172,64],[211,63,172,65,"pathname"],[211,71,172,73],[211,74,172,76],[212,4,173,4],[212,5,173,5],[213,2,174,0],[214,2,175,0],[214,11,175,9,"transformEventDataToApiRequestData"],[214,45,175,43,"transformEventDataToApiRequestData"],[214,46,175,44,"sessionContext"],[214,60,175,58],[214,62,175,60],[215,4,176,4],[215,11,176,12,"eventData"],[215,20,176,21],[215,24,176,21,"Object"],[215,30,176,21],[215,31,176,21,"assign"],[215,37,176,21],[216,6,177,8,"event_name"],[216,16,177,18],[216,18,177,20,"eventData"],[216,27,177,29],[216,28,177,30,"eventName"],[216,37,177,39],[217,6,178,8,"properties"],[217,16,178,18],[217,18,178,20,"eventData"],[217,27,178,29],[217,28,178,30,"properties"],[217,38,178,40],[218,6,179,8,"timestamp"],[218,15,179,17],[218,17,179,19,"eventData"],[218,26,179,28],[218,27,179,29,"timestamp"],[218,36,179,38],[219,6,180,8,"page_url"],[219,14,180,16],[219,16,180,18,"eventData"],[219,25,180,27],[219,26,180,28,"pageUrl"],[220,4,180,35],[220,7,181,11,"sessionContext"],[220,21,181,25],[220,22,182,6],[221,2,183,0],[222,2,184,0],[222,6,184,4,"sessionContextPromise"],[222,27,184,25],[222,30,184,28],[222,34,184,32],[223,2,185,0],[223,17,185,15,"getSessionContext"],[223,34,185,32,"getSessionContext"],[223,35,185,33,"userAuthModule"],[223,49,185,47],[223,51,185,49],[224,4,186,4],[224,8,186,8],[224,9,186,9,"analyticsSharedState"],[224,29,186,29],[224,30,186,30,"sessionContext"],[224,44,186,44],[224,46,186,46],[225,6,187,8],[225,10,187,12],[225,11,187,13,"sessionContextPromise"],[225,32,187,34],[225,34,187,36],[226,8,188,12],[226,14,188,18,"sessionId"],[226,23,188,27],[226,26,188,30,"getAnalyticsSessionId"],[226,47,188,51],[226,48,188,52],[226,49,188,53],[227,8,189,12,"sessionContextPromise"],[227,29,189,33],[227,32,189,36,"userAuthModule"],[227,46,189,50],[227,47,190,17,"me"],[227,49,190,19],[227,50,190,20],[227,51,190,21],[227,52,191,17,"then"],[227,56,191,21],[227,57,191,23,"user"],[227,61,191,27],[227,66,191,33],[228,10,192,16,"user_id"],[228,17,192,23],[228,19,192,25,"user"],[228,23,192,29],[228,24,192,30,"id"],[228,26,192,32],[229,10,193,16,"session_id"],[229,20,193,26],[229,22,193,28,"sessionId"],[230,8,194,12],[230,9,194,13],[230,10,194,14],[230,11,194,15],[230,12,195,17,"catch"],[230,17,195,22],[230,18,195,23],[230,25,195,30],[231,10,196,16,"user_id"],[231,17,196,23],[231,19,196,25],[231,23,196,29],[232,10,197,16,"session_id"],[232,20,197,26],[232,22,197,28,"sessionId"],[233,8,198,12],[233,9,198,13],[233,10,198,14],[233,11,198,15],[234,6,199,8],[235,6,200,8,"analyticsSharedState"],[235,26,200,28],[235,27,200,29,"sessionContext"],[235,41,200,43],[235,44,200,46],[235,50,200,52,"sessionContextPromise"],[235,71,200,73],[236,4,201,4],[237,4,202,4],[237,11,202,11,"analyticsSharedState"],[237,31,202,31],[237,32,202,32,"sessionContext"],[237,46,202,46],[238,2,203,0],[239,2,204,7],[239,11,204,16,"getAnalyticsConfigFromUrlParams"],[239,42,204,47,"getAnalyticsConfigFromUrlParams"],[239,43,204,47],[239,45,204,50],[240,4,205,4],[240,8,205,8],[240,15,205,15,"window"],[240,21,205,21],[240,26,205,26],[240,37,205,37],[240,39,206,8],[240,46,206,15,"undefined"],[240,55,206,24],[241,4,207,4],[241,10,207,10,"urlParams"],[241,19,207,19],[241,22,207,22],[241,26,207,26,"URLSearchParams"],[241,41,207,41],[241,42,207,42,"window"],[241,48,207,48],[241,49,207,49,"location"],[241,57,207,57],[241,58,207,58,"search"],[241,64,207,64],[241,65,207,65],[242,4,208,4],[242,10,208,10,"analyticsEnable"],[242,25,208,25],[242,28,208,28,"urlParams"],[242,37,208,37],[242,38,208,38,"get"],[242,41,208,41],[242,42,208,42,"ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY"],[242,79,208,79],[242,80,208,80],[243,4,209,4],[244,4,210,4],[244,8,210,8,"analyticsEnable"],[244,23,210,23],[244,27,210,27],[244,31,210,31],[244,35,210,35],[244,36,210,36,"analyticsEnable"],[244,51,210,51],[244,52,210,52,"length"],[244,58,210,58],[244,60,211,8],[244,67,211,15,"undefined"],[244,76,211,24],[245,4,212,4],[246,4,213,4],[246,10,213,10,"newUrlParams"],[246,22,213,22],[246,25,213,25],[246,29,213,29,"URLSearchParams"],[246,44,213,44],[246,45,213,45,"window"],[246,51,213,51],[246,52,213,52,"location"],[246,60,213,60],[246,61,213,61,"search"],[246,67,213,67],[246,68,213,68],[247,4,214,4,"newUrlParams"],[247,16,214,16],[247,17,214,17,"delete"],[247,23,214,23],[247,24,214,24,"ANALYTICS_CONFIG_ENABLE_URL_PARAM_KEY"],[247,61,214,61],[247,62,214,62],[248,4,215,4],[248,10,215,10,"newUrl"],[248,16,215,16],[248,19,215,19,"window"],[248,25,215,25],[248,26,215,26,"location"],[248,34,215,34],[248,35,215,35,"pathname"],[248,43,215,43],[248,47,216,9,"newUrlParams"],[248,59,216,21],[248,60,216,22,"toString"],[248,68,216,30],[248,69,216,31],[248,70,216,32],[248,73,216,35],[248,76,216,38],[248,79,216,41,"newUrlParams"],[248,91,216,53],[248,92,216,54,"toString"],[248,100,216,62],[248,101,216,63],[248,102,216,64],[248,105,216,67],[248,107,216,69],[248,108,216,70],[249,4,217,4,"window"],[249,10,217,10],[249,11,217,11,"history"],[249,18,217,18],[249,19,217,19,"replaceState"],[249,31,217,31],[249,32,217,32],[249,33,217,33],[249,34,217,34],[249,36,217,36],[249,38,217,38],[249,40,217,40,"newUrl"],[249,46,217,46],[249,47,217,47],[250,4,218,4],[251,4,219,4],[251,11,219,11],[252,6,219,13,"enabled"],[252,13,219,20],[252,15,219,22,"analyticsEnable"],[252,30,219,37],[252,35,219,42],[253,4,219,49],[253,5,219,50],[254,2,220,0],[255,2,221,7],[255,11,221,16,"getAnalyticsSessionId"],[255,32,221,37,"getAnalyticsSessionId"],[255,33,221,37],[255,35,221,40],[256,4,222,4],[256,8,222,8],[256,15,222,15,"window"],[256,21,222,21],[256,26,222,26],[256,37,222,37],[256,39,222,39],[257,6,223,8],[257,13,223,15],[257,17,223,15,"generateUuid"],[257,29,223,27],[257,30,223,27,"generateUuid"],[257,42,223,27],[257,44,223,28],[257,45,223,29],[258,4,224,4],[259,4,225,4],[259,8,225,8],[260,6,226,8],[260,12,226,14,"sessionId"],[260,21,226,23],[260,24,226,26,"localStorage"],[260,36,226,38],[260,37,226,39,"getItem"],[260,44,226,46],[260,45,226,47,"ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY"],[260,83,226,85],[260,84,226,86],[261,6,227,8],[261,10,227,12],[261,11,227,13,"sessionId"],[261,20,227,22],[261,22,227,24],[262,8,228,12],[262,14,228,18,"newSessionId"],[262,26,228,30],[262,29,228,33],[262,33,228,33,"generateUuid"],[262,45,228,45],[262,46,228,45,"generateUuid"],[262,58,228,45],[262,60,228,46],[262,61,228,47],[263,8,229,12,"localStorage"],[263,20,229,24],[263,21,229,25,"setItem"],[263,28,229,32],[263,29,229,33,"ANALYTICS_SESSION_ID_LOCAL_STORAGE_KEY"],[263,67,229,71],[263,69,229,73,"newSessionId"],[263,81,229,85],[263,82,229,86],[264,8,230,12],[264,15,230,19,"newSessionId"],[264,27,230,31],[265,6,231,8],[266,6,232,8],[266,13,232,15,"sessionId"],[266,22,232,24],[267,4,233,4],[267,5,233,5],[267,6,234,4],[267,13,234,11,"_a"],[267,15,234,13],[267,17,234,15],[268,6,235,8],[268,13,235,15],[268,17,235,15,"generateUuid"],[268,29,235,27],[268,30,235,27,"generateUuid"],[268,42,235,27],[268,44,235,28],[268,45,235,29],[269,4,236,4],[270,2,237,0],[271,0,237,1],[271,3]],"functionMap":{"names":["<global>","getSharedInstance$argument_1","createAnalyticsModule","track","cleanup","batchRequestFallback","beaconRequest","flush","startProcessing","onDocVisible","onDocHidden","onVisibilityChange","stopAnalyticsProcessor","startAnalyticsProcessor","Promise$argument_0","startHeartBeatProcessor","<anonymous>","setInterval$argument_0","getEventIntrinsicData","transformEventDataToApiRequestData","getSessionContext","userAuthModule.me.then$argument_0","userAuthModule.me.then._catch$argument_0","getAnalyticsConfigFromUrlParams","getAnalyticsSessionId"],"mappings":"AAA;4ECkB;EDS;qCEC;mBCM,SD;qBEC,SF;iCGK;KHM;0BIE;KJW;kBKC;KLa;4BMC;KNK;kBCC;KDU;yBOC;KPM;wBQC;KRM;+BSC;KTS;oBEC;KFM;CFa;AYC;CZE;AaC;0BCW,8CD;CbG;AeC;eCI,SD;iCEG;KFE;WCC;KDG;CfC;AkBC;ClBK;AmBC;WHC;MGM;CnBC;AoBE;sBCM;cDG;uBEC;cFG;CpBK;OuBC;CvBgB;OwBC;CxBgB"},"hasCjsExports":false},"type":"js/module"}]}